@using CSSPWebTools.Views.OpenData.Resources;
@using CSSPWebTools.Controllers;
@using CSSPEnumsDLL.Enums;
@using CSSPEnumsDLL.Services;
@using CSSPModelsDLL.Models;
@using System.Linq;

@{
    int MWQMSiteTVItemID = (int)ViewBag.MWQMSiteTVItemID;
    List<MWQMSampleModel> mwqmSampleList = (List<MWQMSampleModel>)ViewBag.MWQMSampleModelList;
    string routineTxt = ((int)SampleTypeEnum.Routine).ToString() + ",";
}

<div class="OpenDataButtonsTopDiv">
    <span>@OpenDataViewRes.MarkAllRoutineSamplesForMWQMSiteAs : </span>
    <span class="OpenDataButtonsDiv">
        <button class="jbOpenDataMarkAllRoutineSamplesAsValidated btn btn-primary" data-tvitemid="@MWQMSiteTVItemID">
            <span>@OpenDataViewRes.Validated</span>
        </button>
        <button class="jbOpenDataMarkAllRoutineSamplesAsNotValidated btn btn-primary" data-tvitemid="@MWQMSiteTVItemID">
            <span>@OpenDataViewRes.NotValidated</span>
        </button>
        <button class="jbOpenDataMarkAllRoutineSamplesAsIsSensitive btn btn-primary" data-tvitemid="@MWQMSiteTVItemID">
            <span>@OpenDataViewRes.IsSensitive</span>
        </button>
        <button class="jbOpenDataMarkAllRoutineSamplesAsNotSensitive btn btn-primary" data-tvitemid="@MWQMSiteTVItemID">
            <span>@OpenDataViewRes.NotSensitive</span>
        </button>
    </span>
    <span class="OpenDataWorkingDiv hidden">
        @OpenDataViewRes.Working ... @OpenDataViewRes.YouCanClickTheStatButtonToSeeTheStatusOfTheTask
    </span>
    <br />
    <hr />
</div>
<table class="table table-striped table-condensed">
    <thead>
        <tr>
            <th>command</th>
            <th>Date</th>
            <th>FC</th>
            <th>Sal</th>
            <th>Temp</th>
            <th>pH</th>
            <th>Depth</th>
            <th>Validated</th>
            <th>Is Sensitive</th>
        </tr>
    </thead>
    <tbody>
        @foreach (MWQMSampleModel mwqmSampleModel in mwqmSampleList.Where(c => c.SampleTypesText.Contains(routineTxt)).OrderByDescending(c => c.SampleDateTime_Local))
        {
            <tr>
                <td>
                    <button class="jbOpenDataMarkSamplesWithMWQMSampleIDAsValidated btn btn-primary" data-mwqmsampleid="@mwqmSampleModel.MWQMSampleID">
                        <span>@OpenDataViewRes.Validated</span>
                    </button>
                    <button class="jbOpenDataMarkSamplesWithMWQMSampleIDAsNotValidated btn btn-primary" data-mwqmsampleid="@mwqmSampleModel.MWQMSampleID">
                        <span>@OpenDataViewRes.NotValidated</span>
                    </button>
                    <button class="jbOpenDataMarkSamplesWithMWQMSampleIDAsIsSensitive btn btn-primary" data-mwqmsampleid="@mwqmSampleModel.MWQMSampleID">
                        <span>@OpenDataViewRes.IsSensitive</span>
                    </button>
                    <button class="jbOpenDataMarkSamplesWithMWQMSampleIDAsNotSensitive btn btn-primary" data-mwqmsampleid="@mwqmSampleModel.MWQMSampleID">
                        <span>@OpenDataViewRes.NotSensitive</span>
                    </button>
                </td>
                <td>
                    @mwqmSampleModel.SampleDateTime_Local.ToString("yyyy MMMM dd")
                </td>
                <td>
                    @(mwqmSampleModel.FecCol_MPN_100ml < 2 ? "< 2" : mwqmSampleModel.FecCol_MPN_100ml.ToString("F0"))
                </td>
                <td>
                    @(mwqmSampleModel.Salinity_PPT != null ? ((float)mwqmSampleModel.Salinity_PPT).ToString("F1") : "")
                </td>
                <td>
                    @(mwqmSampleModel.WaterTemp_C != null ? ((float)mwqmSampleModel.WaterTemp_C).ToString("F1") : "")
                </td>
                <td>
                    @(mwqmSampleModel.PH != null ? ((float)mwqmSampleModel.PH).ToString("F1") : "")
                </td>
                <td>
                    @(mwqmSampleModel.Depth_m != null ? ((float)mwqmSampleModel.Depth_m).ToString("F1") : "")
                </td>
                <td>
                    @(mwqmSampleModel.Validated ? "yes" : "no")
                </td>
                <td>
                    @(mwqmSampleModel.IsSensitive ? "yes" : "no")
                </td>
            </tr>
        }
    </tbody>
</table>

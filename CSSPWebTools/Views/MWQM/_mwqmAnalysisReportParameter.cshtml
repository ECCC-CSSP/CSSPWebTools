@using CSSPWebTools.Models;
@using CSSPWebTools.Views.MWQM.Resources;
@using CSSPWebTools.Views.Shared.Resources;
@using CSSPWebTools.Controllers;
@using CSSPEnumsDLL.Enums;
@using CSSPEnumsDLL.Services;
@using CSSPModelsDLL.Models;

@{
    int SubsectorTVItemID = (int)ViewBag.SubsectorTVItemID;
    List<MWQMAnalysisReportParameterModel> mwqmAnalysisReportParameterModelList = (List<MWQMAnalysisReportParameterModel>)ViewBag.MWQMAnalysisReportParameterModelList;
    BaseEnumService _BaseEnumService = new BaseEnumService(ViewBag.Language);
}

<label>Existing an export to Excel</label>
<select class="form-control" name="MWQMAnalysisReportParameterSaveCreateOrExportToExcel">
    <option value="Export" selected="selected">@MWQMViewRes.ExportToExcelDocument</option>
    <option value="Save">@MWQMViewRes.SaveForReport</option>
    @foreach (MWQMAnalysisReportParameterModel mwqmAnalysisReportParameterModel in mwqmAnalysisReportParameterModelList)
    {
        <option value="@("View_" + mwqmAnalysisReportParameterModel.MWQMAnalysisReportParameterID)">@(mwqmAnalysisReportParameterModel.AnalysisName + " (" + mwqmAnalysisReportParameterModel.AnalysisReportYear + ")" + (mwqmAnalysisReportParameterModel.Command == AnalysisReportExportCommandEnum.Excel ? " [Excel]" : ""))</option>
    }
</select>
<div class="InputAnalysisNameDiv hidden">
    <label class="InputExcelFileName" for="InputAnalysisName">@MWQMViewRes.ExcelFileName</label>
    <label class="InputAnalysisName hidden" for="InputAnalysisName">@MWQMViewRes.NewAnalysisName</label>
    <input class="InputAnalysisName form-control" type="text" value="" name="InputAnalysisName" /><br />
    <label for="AnalysisReportYear">@MWQMViewRes.AnalysisReportYear</label><input class="AnalysisReportYear form-control" type="text" value="" name="AnalysisReportYear" /><br />
</div>
<button class="jbMWQMSubsectorAnalysisSaveCreateOrExportToExcel btn btn-default">@MWQMViewRes.ExportToExcelDocument</button>
@foreach (MWQMAnalysisReportParameterModel mwqmAnalysisReportParameterModel in mwqmAnalysisReportParameterModelList)
{
    <div class="MWQMAnalysisReportParameter hidden" data-parameterid="@mwqmAnalysisReportParameterModel.MWQMAnalysisReportParameterID">
        <blockquote>
            <span class="AnalysisName">@mwqmAnalysisReportParameterModel.AnalysisName</span>
            (<span class="AnalysisReportYear">@mwqmAnalysisReportParameterModel.AnalysisReportYear</span>),
            <span class="StartDate">@mwqmAnalysisReportParameterModel.StartDate.ToString("yyyy-MM-dd")</span> to
            <span class="EndDate">@mwqmAnalysisReportParameterModel.EndDate.ToString("yyyy-MM-dd")</span>,
            <span class="AnalysisCalculationType">@(_BaseEnumService.GetEnumText_AnalysisCalculationTypeEnum(mwqmAnalysisReportParameterModel.AnalysisCalculationType))</span>,
            <span class="NumberOfRuns">@mwqmAnalysisReportParameterModel.NumberOfRuns]</span> runs,
            <span class="FullYear hidden">mwqmAnalysisReportParameterModel.FullYear</span>
            @if (mwqmAnalysisReportParameterModel.FullYear)
                {
                <span>@MWQMViewRes.UseFullYear</span>
            }
            else
            {
                <span class="text-strikeThrough">@MWQMViewRes.UseFullYear</span>
            }
            ,
            <span>@MWQMViewRes.Sal (</span><span class="SalinityHighlightDeviationFromAverage">@mwqmAnalysisReportParameterModel.SalinityHighlightDeviationFromAverage]</span>),
            <span>@MWQMViewRes.ShortRangeNumberOfDays</span> (<span class="ShortRangeNumberOfDays">@mwqmAnalysisReportParameterModel.ShortRangeNumberOfDays]</span>),
            <span>@MWQMViewRes.MidRangeNumberOfDays</span> (<span class="MidRangeNumberOfDays">@mwqmAnalysisReportParameterModel.MidRangeNumberOfDays</span>)
            <table class="table table-condensed">
                <tr>
                    <th>&nbsp;</th>
                    <th>24h</th>
                    <th>48h</th>
                    <th>72h</th>
                    <th>96h</th>
                </tr>
                <tr>
                    <td>@MWQMViewRes.Dry</td>
                    <td><span class="DryLimit24h">@mwqmAnalysisReportParameterModel.DryLimit24h]</span></td>
                    <td><span class="DryLimit48h">@mwqmAnalysisReportParameterModel.DryLimit48h]</span></td>
                    <td><span class="DryLimit72h">@mwqmAnalysisReportParameterModel.DryLimit72h]</span></td>
                    <td><span class="DryLimit96h">@mwqmAnalysisReportParameterModel.DryLimit96h]</span></td>
                </tr>
                <tr>
                    <td><span class="WetLimit24h">@mwqmAnalysisReportParameterModel.WetLimit24h]</span></td>
                    <td><span class="WetLimit48h">@mwqmAnalysisReportParameterModel.WetLimit48h]</span></td>
                    <td><span class="WetLimit72h">@mwqmAnalysisReportParameterModel.WetLimit72h]</span></td>
                    <td><span class="WetLimit96h">@mwqmAnalysisReportParameterModel.WetLimit96h]</span></td>
                </tr>
            </table>
            <span class="RunsToOmit hidden">@mwqmAnalysisReportParameterModel.RunsToOmit</span>
            <span class="RunsToOmitShowDates">]</span>
            <span class="ExcelTVFileTVItemID hidden">@mwqmAnalysisReportParameterModel.ExcelTVFileTVItemID</span>
            <span class="Command hidden">@mwqmAnalysisReportParameterModel.Command</span>
            <br />
            @if (mwqmAnalysisReportParameterModel.Command == AnalysisReportExportCommandEnum.Excel)
            {
                <span>@MWQMViewRes.ExcelFileName :</span> <span class="ExcelTVFileTVText">@(mwqmAnalysisReportParameterModel.ExcelTVFileTVText == null ? "" : mwqmAnalysisReportParameterModel.ExcelTVFileTVText)</span>
            }
            <br />
            <button class="jbMWQMSubsectorAnalysisReportParameterOrExcelDelete btn btn-default">@MWQMViewRes.DeleteAnalysis</button>
        </blockquote>
    </div>
}
<script type="text/javascript">
    $(function () {
        cssp.MWQMSite.AfterLoadParameter();
    });
</script>
